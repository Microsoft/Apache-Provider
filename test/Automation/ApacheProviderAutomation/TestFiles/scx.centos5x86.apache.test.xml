<?xml version="1.0" encoding="utf-8"?>
<varmap xmlns="http://smxinfranet/schemas/mcf/2002/01/varmap"
        assembly="..\Apache.dll"
        dsc="Apache Automation Test"
        owner="v-litin" contact="v-litin">

  <snippet id="ApacheInstallInfo">
    <rec key="Apache.InstallCmd">sh /tmp/{0}</rec>
    <rec key="Apache.VerifyFolderExistCmd"><![CDATA[/bin/ls /opt/microsoft/|grep -ic "apache";/bin/ls /var/opt/microsoft/|grep -ic "apache";/bin/ls /etc/opt/microsoft/|grep -ic "apache"]]></rec>
    <rec key="Apache.VerifyApacheInstalledCmd">rpm -qa|grep apache</rec>
  </snippet>
  <snippet id="UniqueApacheServerInfo">
    <rec key="ApacheServer.ConfFile">/etc/httpd/conf/httpd\.conf</rec>
    <rec key="ApacheServer.Vendor">Apache Software Foundation</rec>
    <rec key="ApacheServer.ProductVersion">2\.2\.3</rec>
    <rec key="ApacheServer.ProcessName">httpd</rec>
    <rec key="ApacheServer.Collection">/etc/httpd</rec>
  </snippet>
  <snippet id="LinuxInfo">
    <rec key="Linux.Host">osst-cen5x86-01</rec>
  </snippet>
  <!-- Test Case information -->

  <var set="1" lvl="0" vid="724411" cid="Apache_HTTPDServer" cls="Scx.Test.Apache.Provider.VerifyEnumerate" dsc="Verify enumeration of Apache_HTTPDServer works for 1 Apache Server." act="true">
    <snipref id="UniqueApacheServerInfo" />
    <snipref id="LinuxInfo" />
    <rec key="p:InstanceID">%ApacheServer.ConfFile%</rec>
    <rec key="p:Caption">^$</rec>
    <rec key="p:Description">^$</rec>
    <rec key="p:ElementName">^$</rec>
    <rec key="p:ProductIdentifyingNumber">[0-9]</rec>
    <rec key="p:ProductName">%ApacheServer.ConfFile%</rec>
    <rec key="p:ProductVendor">%ApacheServer.Vendor%</rec>
    <rec key="p:ProductVersion">%ApacheServer.ProductVersion%</rec>
    <rec key="p:SystemID">%Linux.Host%</rec>
    <rec key="p:CollectionID">%ApacheServer.Collection%</rec>
    <rec key="p:Name">^$</rec>
    <rec key="p:ModuleVersion">[0-9].[0-9].[0-9]-[0-9]{3} \([0-9]{8}\)</rec>
    <rec key="p:ConfigurationFile">%ApacheServer.ConfFile%</rec>
    <rec key="p:InstalledModules">[A-Za-z0-9]+.c</rec>
    <rec key="p:InstalledModulesFormatted">[A-Za-z0-9]+.c</rec>
    <rec key="p:ProcessName">%ApacheServer.ProcessName%</rec>
    <rec key="p:ServiceName">%ApacheServer.ProcessName%</rec>
    <rec key="p:OperatingStatus">OK</rec>
    <rec key="p:OperatingStatusDetail">^$</rec>
  </var>

  <!-- 724953-VerifyCimProvInstallationUsingOptionInstall -->
  <var set="2" lvl="0" vid="724953" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if install Apache agent successfully with '--install' option" act="true">
    <snipref id="ApacheInstallInfo" />
    <rec key="apacheCmd">sh /tmp/{0} --install</rec>
    <rec key="isInvalidInstall">false</rec>
    <rec key="verifyFolderExistCmd">%Apache.VerifyFolderExistCmd%</rec>
    <!-- The apache-cimprov folder under /opt/microsoft and /var/opt/microsoft and /etc/opt/microsoft should be 1,1,1 -->
    <rec key="expectedFolderCount">1,1,1</rec>
    <rec key="installLogKeyWorlds">OK</rec>
    <rec key="verifyApacheInstalledCmd">%Apache.VerifyApacheInstalledCmd%</rec>
  </var>

  <!-- 724954-VerifyCimProvInstallationUsingOptionInstallAndForce -->
  <var set="2" lvl="0" vid="724954" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if install Apache agent successfully with '--install --force' option" act="true">
    <snipref id="ApacheInstallInfo" />
    <rec key="apacheCmd">sh /tmp/{0} --install --force</rec>
    <rec key="isInvalidInstall">false</rec>
    <!-- The apache-cimprov folder under /opt/microsoft and /var/opt/microsoft and /etc/opt/microsoft should be 1,1,1 -->
    <rec key="expectedFolderCount">1,1,1</rec>
    <rec key="installLogKeyWorlds">OK</rec>
    <rec key="verifyFolderExistCmd">%Apache.VerifyFolderExistCmd%</rec>
    <rec key="verifyApacheInstalledCmd">%Apache.VerifyApacheInstalledCmd%</rec>
  </var>

  <!-- 724955-VerifyCimProvInstallationtwicefailed -->
  <var set="2" lvl="0" vid="724955" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if install an Apache agent twice failed on the same version" act="true">
    <rec key="apacheCmd">sh /tmp/{0} --install</rec>
    <rec key="isInvalidInstall">true</rec>
    <rec key="installTwice">true</rec>
  </var>

  <!-- 724956-VerifyCimProvInstallationUsingInvalidOptions-->
  <var set="2" lvl="0" vid="724956" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if install an Apache agent failed with invalid option" act="true">
    <rec key="apacheCmd">sh /tmp/{0} --invalidinstall</rec>
    <rec key="isInvalidInstall">true</rec>
  </var>

  <!-- 724957-VerifyCimProvInstallationWithOutOption -->
  <var set="2" lvl="0" vid="724957" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if install an Apache agent failed without options" act="true">
    <rec key="apacheCmd">sh /tmp/{0}</rec>
    <rec key="isInvalidInstall">true</rec>
    <rec key="installLogKeyWorlds">usage</rec>
  </var>

  <!-- 724963-VerifyCimProvUsingRemoveOption -->
  <var set="2" lvl="0" vid="724963" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if uninstall Apache agent successfully with '--remove' option" act="true">
    <snipref id="ApacheInstallInfo" />
    <rec key="apacheCmd">sh /tmp/{0} --remove</rec>
    <rec key="isRemoveOption">true</rec>
    <rec key="expectedFolderCount">0,0,0</rec>
    <rec key="verifyFolderExistCmd">%Apache.VerifyFolderExistCmd%</rec>
    <rec key="verifyApacheInstalledCmd">%Apache.VerifyApacheInstalledCmd%</rec>
  </var>

  <!-- 724964-VerifyCimProvUsingpurgeOption -->
  <var set="2" lvl="0" vid="724964" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if uninstalll Apache agent cleanly with '--purge' option" act="true">
    <snipref id="ApacheInstallInfo" />
    <rec key="apacheCmd">sh /tmp/{0} --purge</rec>
    <rec key="isRemoveOption">true</rec>
    <rec key="expectedFolderCount">0,0,0</rec>
    <rec key="verifyFolderExistCmd">%Apache.VerifyFolderExistCmd%</rec>
    <rec key="verifyApacheInstalledCmd">%Apache.VerifyApacheInstalledCmd%</rec>
  </var>

  <!-- 724965-VerifyCimProvHelpOption -->
  <var set="2" lvl="0" vid="724965" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProv" dsc="[Apache]Verify if output the usage properly when type '--help' option" act="true">
    <rec key="apacheCmd">sh /tmp/{0} --help</rec>
    <rec key="isHelpOption">true</rec>
  </var>

  <!-- 724958-VerifyCimProvUpgradeOption -->
  <var set="2" lvl="0" vid="724958" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProvCompatibility" dsc="[Apache]Verify if upgrade Apache agent successfully with '--upgrade' option" act="true">
    <snipref id="ApacheInstallInfo" />
    <rec key="installOlderApacheCmd">sh /tmp/{0} --install</rec>
    <rec key="oldApachesLocation"><![CDATA[C:\Apache\cimprov\old]]></rec>
    <rec key="apacheCmd">sh /tmp/{0} --upgrade</rec>
    <rec key="isUpgrade">true</rec>
    <rec key="expectedFolderCount">1,1,1</rec>
    <rec key="verifyFolderExistCmd">%Apache.VerifyFolderExistCmd%</rec>
    <rec key="verifyApacheInstalledCmd">%Apache.VerifyApacheInstalledCmd%</rec>
  </var>

  <!-- 724961-VerifyCimProvUpgradeUsingForceOption -->
  <var set="2" lvl="0" vid="724961" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProvCompatibility" dsc="[Apache]Verify if upgrade Apache agent successfully with '--upgrade --force' option" act="true">
    <snipref id="ApacheInstallInfo" />
    <rec key="installOlderApacheCmd">sh /tmp/{0} --install</rec>
    <rec key="oldApachesLocation"><![CDATA[C:\Apache\cimprov\old]]></rec>
    <rec key="apacheCmd">sh /tmp/{0} --upgrade --force</rec>
    <rec key="isUpgrade">true</rec>
    <rec key="expectedFolderCount">1,1,1</rec>
    <rec key="verifyFolderExistCmd">%Apache.VerifyFolderExistCmd%</rec>
    <rec key="verifyApacheInstalledCmd">%Apache.VerifyApacheInstalledCmd%</rec>
  </var>

  <!-- 724962-VerifyCimProvDoesNotUpgradeToLowerVersion-->
  <var set="2" lvl="0" vid="724962" cid="VerifyCimProv" cls="Scx.Test.Apache.Provider.VerifyCimProv.VerifyCimProvCompatibility" dsc="[Apache]Verify if upgrade Apache agent successfully with '--upgrade --force' option" act="true">
    <rec key="oldApachesLocation"><![CDATA[C:\Apache\cimprov\old]]></rec>
    <rec key="apacheCmd">sh /tmp/{0} --upgrade</rec>
    <rec key="isUpgrade">false</rec>
  </var>

  <!-- Test Variables Definition -->
  <grp cls="Scx.Test.Apache.Provider.GroupHelper">
    <snipref id="LinuxInfo" />
    <rec key="hostname">%Linux.Host%</rec>
    <rec key="omserver">osst-w12r2-01</rec>
    <rec key="username">root</rec>
    <rec key="password">OpsMgr2007R2</rec>
    <rec key="nonsuperuser">scxuser</rec>
    <rec key="nonsuperuserpwd">scxuser</rec>
    <rec key="PlatformTag">universalr.1.x86</rec>
    <rec key="ApacheTag">universal.1.i686</rec>
    <rec key="InstallOMCmd">sh /tmp/{0} --install</rec>
    <rec key="UninstallOMCmd">/opt/microsoft/scx/bin/uninstall</rec>
    <rec key="CleanupOMCmd"><![CDATA[/opt/microsoft/scx/bin/uninstall;rm -rf /etc/opt/microsoft/;rm -rf /opt/microsoft;rm -rf /tmp/scx*;rm -rf /var/opt/microsoft]]></rec>
    <rec key="AgentPkgExt">rpm</rec>
    <rec key="DirectoryTag">CentOS5.0_x86</rec>
    <rec key="installonly">false</rec>
    <rec key="knownIssueFormat">Known Issue: WI {0}: '{1}'</rec>
    <rec key="OMAgentLocation"><![CDATA[C:\Program Files\Microsoft System Center 2012 R2\Operations Manager\Server\AgentManagement\UnixAgents]]></rec>
    <!--cimprov-->
    <rec key="ApachesLocation"><![CDATA[C:\Apache\cimprov]]></rec>
    <rec key="installApacheCmd">sh /tmp/{0} --install</rec>
    <rec key="UninstallApacheCmd">sh /tmp/{0} --purge</rec>
    <rec key="CleanupApacheCmd"><![CDATA[sh /tmp/{0} --purge;rm -rf /etc/opt/microsoft/apache*;rm -rf /opt/microsoft/apache*;rm -rf /var/opt/microsoft/apache*;]]></rec>
    <!--check apache status-->
    <rec key="installApachePkg">yum install httpd</rec>
    <rec key="startApacheCmd">service httpd start</rec>
    <rec key="checkServiceCmd">service httpd status</rec>
    <!--<rec key="checkApacheInstalled">rpm -qa |grep httpd</rec>-->

    <!-- If this is true, ignore the remote agent drop folder, and use only local agents found in the pat given by 'OMAgentLocation' -->
    <rec key="useagentlocation">true</rec>
    <rec key="useapacheLocation">true</rec>
    <!-- Use only the latest agent: if an agent is not available in the latest build folder, exit with an error -->
    <rec key="latestonly">true</rec>
    <!-- Skip agent deployment: run WSMAN tests without attempting to install a new agent on the client machine, and don't uninstall the agent when testing is done-->
    <rec key="skipagentdeploy">false</rec>
    <varref />
  </grp>
</varmap>